# Keymap Optimization  
Prioritize ergonomics and comfort over typing speed.


## 0. Manual Optimization
I designed a keymap based on English [letter](https://norvig.com/mayzner.html) and [character](http://xahlee.info/comp/computer_language_char_distribution.html) frequencies.
<img src="./Layer0.PNG">  

[As in Keyboard Layout Editor](http://keyboard-tool.pimpmykeyboard.com/##@_name=EVK%2F_v1.3&author=Yang%20Cui&notes=The%20%22symbol%20key%22%20accesses%20the%20symbols%20marked%20at%20the%20top%20left%20cornors%20on%20the%20keycaps.%0AThe%20%22Modifcn.%20Key%20Lock%22%20locks%20the%20modification%20keys%20%22Symbol%22%20and%20%22Shift%22.%3B&@_x:2.5&f:5&w:1.25&h:1.25%3B&=%0A%0A%23%0A3&_x:15.25&w:1.25&h:1.25%3B&=%0A%0A*%0A8%3B&@_y:-0.75&x:1.25&w:1.25&h:1.25%3B&=%0A%0A%2F@%0A2&_x:1.25&w:1.25&h:1.25%3B&=%0A%0A$%0A4&_w:1.25&h:1.25%3B&=%0A%0A%25%0A5&_w:1.25&h:1.25%3B&=%0A%0A%0AESC&_x:7.75&w:1.25&h:1.25%3B&=%0A%0A%0ALayer%20Toggle&_w:1.25&h:1.25%3B&=%0A%0A%5E%0A6&_w:1.25&h:1.25%3B&=%0A%0A%2F&%0A7&_x:1.25&w:1.25&h:1.25%3B&=%0A%0A(%0A9%3B&@_y:-0.75&w:1.25&h:1.25%3B&=%0A%0A!%0A1&_x:20.25&w:1.25&h:1.25%3B&=%0A%0A)%0A0%3B&@_y:-0.25&x:2.5&w:1.25&h:1.25%3B&=%0A%0AF%0Af&_x:15.25&w:1.25&h:1.25%3B&=%0A%0AO%0Ao%3B&@_y:-0.75&x:1.25&w:1.25&h:1.25%3B&=%0A%0AH%0Ah&_x:1.25&w:1.25&h:1.25%3B&=%0A%0AR%0Ar&_w:1.25&h:1.25%3B&=%0A%0AX%0Ax&_w:1.25&h:1.25%3B&=%0A%0A%0APrint%20Scr&_x:7.75&w:1.25&h:1.25%3B&=%0A%0A%0ACaps%20Lock&_x:1.25&w:1.25&h:1.25%3B&=%0A%0AY%0Ay&_x:1.25&w:1.25&h:1.25%3B&=%0A%0AU%0Au%3B&@_y:-0.75&w:1.25&h:1.25%3B&=%0A%0AQ%0Aq&_x:20.25&w:1.25&h:1.25%3B&=%0A%0AJ%0Aj%3B&@_y:-0.25&x:2.5&c=%232fa342&w:1.25&h:1.25%3B&=%0A%0AN%0An&_x:15.25&w:1.25&h:1.25%3B&=%0A%0AA%0Aa%3B&@_y:-0.75&x:1.25&w:1.25&h:1.25%3B&=%0A%0AS%0As&_x:1.25&w:1.25&h:1.25%3B&=%0A%0AT%0At&_c=%23cccccc&w:1.25&h:1.25%3B&=%0A%0AD%0Ad&_w:1.25&h:1.25%3B&=%0A%0A%7B%0A%5B&_x:7.75&w:1.25&h:1.25%3B&=%0A%0A%7D%0A%5D&_w:1.25&h:1.25%3B&=%0A%0AP%0Ap&_c=%232fa342&w:1.25&h:1.25%3B&=%0A%0AI%0Ai&_x:1.25&w:1.25&h:1.25%3B&=%0A%0AE%0Ae%3B&@_y:-0.75&w:1.25&h:1.25%3B&=%0A%0AL%0Al&_x:20.25&w:1.25&h:1.25%3B&=%0A%0AK%0Ak%3B&@_y:-0.25&x:2.5&c=%23cccccc&w:1.25&h:1.25%3B&=%0A%0AC%0Ac&_x:15.25&w:1.25&h:1.25%3B&=%0A%0A%3C%0A,%3B&@_y:-0.75&x:1.25&w:1.25&h:1.25%3B&=%0A%0AM%0Am&_x:1.25&w:1.25&h:1.25%3B&=%0A%0AV%0Av&_w:1.25&h:1.25%3B&=%0A%0AB%0Ab&_x:10.25&w:1.25&h:1.25%3B&=%0A%0AW%0Aw&_w:1.25&h:1.25%3B&=%0A%0AG%0Ag&_x:1.25&w:1.25&h:1.25%3B&=%0A%0A%3E%0A.%3B&@_y:-0.75&w:1.25&h:1.25%3B&=%0A%0AZ%0Az&_x:20.25&a:7&w:1.25&h:1.25%3B&=Enter%3B&@_y:-0.25&x:2.5&a:4&w:1.25&h:1.25%3B&=%0A%0A+%0A%2F=&_x:15.25&w:1.25&h:1.25%3B&=%0A%0A%2F:%0A%2F%3B%3B&@_y:-0.75&x:1.25&w:1.25&h:1.25%3B&=%0A%0A%2F_%0A-&_x:1.25&a:7&w:1.25&h:1.25%3B&=Tab&_x:12.75&a:4&w:1.25&h:1.25%3B&=%0A%0A%22%0A'&_x:1.25&a:0&w:1.25&h:1.25%3B&=%0A%0A%3F%0A%2F%2F%0A.%3B&@_y:-0.75&a:7&w:1.25&h:1.25%3B&=ALT&_x:20.25&w:1.25&h:1.25%3B&=ALT%3B&@_y:-0.75&x:14.75&w:1.25&h:1.25%3B&=Del%3B&@_y:-0.5&x:2.5&a:4&w:1.25&h:1.25%3B&=%0A%0A~%0A%60&_x:15.25&w:1.25&h:1.25%3B&=%0A%0A%7C%0A%5C%3B&@_y:-0.75&x:1.25&a:7&w:1.25&h:1.25%3B&=Shift&_x:17.75&w:1.25&h:1.25%3B&=Shift%3B&@_ry:4.25&y:-4&x:8.75&a:4&w:1.25&h:1.25%3B&=%0A%0A%0AF1&_w:1.25&h:1.25%3B&=%0A%0A%0AF2&_w:1.25&h:1.25%3B&=%0A%0A%0AF3&_w:1.25&h:1.25%3B&=%0A%0A%0AF4%3B&@_y:0.25&x:8.75&w:1.25&h:1.25%3B&=%0A%0A%0AF5&_w:1.25&h:1.25%3B&=%0A%0A%0AF6&_w:1.25&h:1.25%3B&=%0A%0A%0AF7&_w:1.25&h:1.25%3B&=%0A%0A%0AF8&_x:2.75&a:7&w:1.25&h:1.25%3B&=Back%20Space%3B&@_y:0.25&x:8.75&a:4&w:1.25&h:1.25%3B&=%0A%0A%0AF9&_w:1.25&h:1.25%3B&=%0A%0A%0AF10&_w:1.25&h:1.25%3B&=%0A%0A%0AF11&_w:1.25&h:1.25%3B&=%0A%0A%0AF12%3B&@_y:0.25&x:8.75&a:7&w:1.25&h:1.25%3B&=PgUp&_w:1.25&h:1.25%3B&=%E2%86%91&_w:1.25&h:1.25%3B&=PgDn&_w:1.25&h:1.25%3B&=Home%3B&@_y:-0.5&x:6.75&a:4&w:1.25&h:1.25%3B&=%0A%0A%0ACtrl&_x:6.75&w:1.25&h:1.25%3B&=%0A%0A%0ACtrl%3B&@_y:-0.25&x:8.75&a:7&w:1.25&h:1.25%3B&=%E2%86%90&_w:1.25&h:1.25%3B&=%E2%86%93&_w:1.25&h:1.25%3B&=%E2%86%92&_w:1.25&h:1.25%3B&=End%3B&@_y:-0.5&x:5.5&c=%232fa342&a:4&w:1.25&h:1.25%3B&=%0ASpace&_c=%23cccccc&a:7&w:1.25&h:1.25%3B&=Win%20%2F%2F%20Mac&_x:8&c=%232fa342&a:4&w:1.25&h:1.25%3B&=%0ASpace)One needs the output .json file for customizing the QMK firmware later.  
It fares OK against other traidtional layouts in the [Keyboard Layout Analyzer](http://patorjk.com/keyboard-layout-analyzer/#/load/hqrGn4NG)   


## Algorithmic Optimization - In Progress  
The layout should accommodate world's languages according to their usage.

### 1. Preparation
[The Carpalx Layout - simulated annealing](http://mkweb.bcgsc.ca/carpalx/?simulated_annealing) | [white_keyboard_layout](https://github.com/mw8/white_keyboard_layout) | [ThinQu Layout](https://microexploitation.com/2018/06/04/thinqu/)  

Download sample word data. [World's Language Usage](https://www.vistawide.com/languages/top_30_languages.htm)
[English Letter Frequencies](https://norvig.com/mayzner.html)
[Chinese Letter Frequencies](http://xahlee.info/kbd/chinese_pinyin_letter_frequency.html)
Weight the frequencies with the ratio of total number of speakers of each language.
[Top 30 languages of the world](https://www.vistawide.com/languages/top_30_languages.htm)

Get symbol frequencies for 'spaces', 'enter', 'comma'... from literature and from codes in (C++, Python, etc.). 
[http://xahlee.info/comp/computer_language_char_distribution.html](http://xahlee.info/comp/computer_language_char_distribution.html)


### 2. Scoring Logic:
Each finger's usage should be proportional to its strength, the cube of its diameter.  
Diameter of my left index finder (LI): 56mm / LM: 54mm / LR: 53mm / LP: 47mm
So the ratio of finger key presses should be 1.69 : 1.52 : 1.43 : 1.

how comfortably one presses simple operations such as 'ctrl + c' needs to be taken into account.

If a hand changes row, the other hand types two charactors.  
Change two rows with two different finger better than change two rows with the same finger.

switch 1 or 2 rows needs the other hand to type two letters to be optimal. Switching 3 rows requires the other hand to strike 3 times.

make the right index and mid fingers type slightly less, as most people use these two fingers to click the mouse.

### 3. Implementation

class Key
{
private:
	
}

finger class


Next step:
1. ~~Break down the problem into smaller parts for C++.~~
2. Figure out how to do simulated annealling. 

###### [ODC Open Database License v1.0](https://choosealicense.com/appendix/)  (free but no patent or commercial use)